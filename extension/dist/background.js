function n(){chrome.windows.create({url:"https://everything-pilot.vercel.app/sign-in",type:"popup",width:480,height:620})}chrome.runtime.onStartup.addListener(()=>{chrome.storage.local.get("jwt",e=>{e.jwt?console.log("ðŸ” Token found:",e.jwt.slice(0,10)+"..."):(console.log("ðŸ”’ No token found. Triggering login popup."),n())})});chrome.runtime.onInstalled.addListener(()=>{chrome.storage.local.get("jwt",e=>{e.jwt||(console.log("ðŸ”’ First-time install: Opening login popup."),n())})});chrome.runtime.onMessage.addListener((e,r,t)=>{if(console.log("ðŸ” Message received:",e),e.type==="CLERK_EXTENSION_AUTH"){console.log("its clerk extension auth");const{token:o}=e;chrome.storage.local.set({jwt:o}),console.log("âœ… Token received and stored:",o),console.log("get token",chrome.storage.local.get("jwt")),t({success:!0})}});chrome.runtime.onMessageExternal.addListener((e,r,t)=>{if(console.log("ðŸ” External message received:",e),(e==null?void 0:e.type)==="CLERK_EXTENSION_AUTH"){const{token:o}=e;return chrome.storage.local.set({jwt:o},()=>{console.log("âœ… Token received and stored:",o),chrome.storage.local.get("jwt",l=>{console.log("ðŸ”Ž Verified stored token:",l.jwt)}),t({success:!0})}),!0}});
